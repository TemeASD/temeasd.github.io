<!DOCTYPE html><html lang="fi"><head>
	<title>Projektiesittely - Kyyti.in </title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Kyyti.in palvelun projektiesittely/">
	<meta name="keywords" content="Portfolio">
	<link rel="stylesheet" href="assets/css/main.css">
	<link rel="icon" type="image/x-icon" href="/favicon.png">
	<meta property="og:url" content="temeasd.github.io/">
	<meta property="og:type" content="website">
	<meta property="og:title" content="Teemu P&#xF6;lkin portfolio ja kotisivut">
	<meta property="og:image" content="/images/portfolio.png">
	<meta property="og:image:type" content="image/png">
	<meta property="og:image:width" content="666">
	<meta property="og:image:height" content="259">
	<meta property="og:image:alt" content="Portfolio header">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
	<link rel="stylesheet" href="assets/css/prism.css">
</head>

<body class="is-preload">
    <header id="header">
    <a class="logo" href="index.html">About</a>
    <nav>
        <a href="#menu">Valikko</a>
    </nav>
</header>
    <!-- Highlights -->
    <section class="wrapper">
        <div class="inner">
            <header class="special">
    
                <a target="_blank" href="https://kyyti.in"> <h2>Kyyti.in</h2></a>
                <div class="content">
                    <header>
                        <a href="#">
                            <img class="logot" src="images/kyyti.webp" alt="ag logo">
                        </a>
                    </header>
                    <p>Kyyti.in on uuden ajan kimppakyytipalvelu, joka tekee kimppakyytien sopimisesta todella helppoa ja k&#xE4;tev&#xE4;&#xE4;.</p><br>
                        <h2>HANKITTU OSAAMINEN JA STATSIT</h2>
                </div>
            </header>
            <div class="highlights">
                <section>
                    <div class="content">
                        <div>
                            <header>
                                <h3>Frontend</h3>
                                <img class="logot" src="images/angular.webp" alt="teamapp logo">
                                <h4>Angular 5</h4>
                            </header>
                        <h4>Hankittu osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>Ty&#xF6;skentely produktiossa</li>
                                <li>Asynkroninen ohjelmointi</li>
                                <li>Lomakkeet ja validointi</li>
                                <li>UI/UX Design</li>
                                <li>Responsiivinen webdesign</li>
                            </ul>
                        </div>
                        <h4>Syvennetty osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>Angularin perusteet</li>
                                <li>Autentikaatio</li>
                                <li>CSS3, HTML5, Flexbox</li>
                            </ul>
                        </div>
                        </div>
                    </div>
                </section>
                <section>
                    <div class="content">
                            <header>
                                <h3>Backend</h3>
                                <img class="logot" src="images/nodejs.webp" alt="nodejs logo">
                                <h4>Node.JS</h4>
                            </header>
                        <h4>Hankittu osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>Ty&#xF6;skentely produktiossa</li>
                                <li>Asynkroninen REST rajapinta</li>
                                <li>Virheenk&#xE4;sittely</li>
                            </ul>
                        </div>
                        <h4>Syvennetty osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>CRUD reitit</li>
                                <li>Virheenk&#xE4;sittely</li>
                                <li>Autentikaatio</li>
                            </ul>
                        </div>
                    </div>
                </section>
                <section>
                    <div class="content">
                            <header>
                                <h3>Tietokanta</h3>
                                <img class="logot" src="images/mariadb.webp" alt="mongo logo">
                                <h4>MariaDB</h4>
                            </header>
                        <h4>Hankittu osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>Ty&#xF6;skentely produktiossa</li>
                                <li>MariaDB</li>
                                <li>Sequelize framework</li>
                            </ul>
                        </div>
                        <h4>Syvennetty osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>ER-mallinnus ja transformointi</li>
                                <li>Tietokannan luominen</li>
                                <li>SQLn perusteet</li>
                            </ul>
                        </div>
                    </div>
                </section>
            </div>
            <div class="highlights">
                <section>
                    <div class="content">
                        <div>
                            <header>
                                <h3>Versionhallinta</h3>
                                <img class="logot" src="images/git.webp" alt="git logo">
                                <h4>GIT</h4>
                            </header>
                        <h4>Syvennetty osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>GITin perusteet</li>
                                <li>GitLabin k&#xE4;ytt&#xF6;</li>
                                <li>Merge konfliktien selvittely</li>
                            </ul>
                        </div>
                        </div>
                    </div>
                </section>
                <section>
                    <div class="content">
                            <header>
                                <h3>K&#xE4;ytetyt ohjelmistot</h3>
                                <img class="logot" src="images/software.webp" alt="software logo">
                                <h4>&#x200B;</h4>
                            </header>
                            <h4>Syvennetty osaaminen</h4>
                        <div class="taulukko">
                            <ul>
                                <li>PowerShell</li>
                                <li>VS Code</li>
                                <li>GIT Bash</li>
                                <li>Ubuntu 16.04</li>
                                <li>Nginx</li>
                                <li>NPM</li>
                                <li>PuTTy &amp; WinSCP</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="content">
                            <header>
                                <h3>STATSIT</h3>
                                <img class="logot" src="images/stats.jpg" alt="123 logo">
                                <h4>&#x200B;</h4>
                            </header>
                            <h4>Ty&#xF6;t</h4>
                        <div class="taulukko">
                            <ul>
                                <li>Nelj&#xE4; kuukautta</li>
                                <li>Yhteens&#xE4; yli 800 ty&#xF6;tuntia</li>
                                <li>367 committia</li>
                                <li>3103 rivi&#xE4; TypeScripti&#xE4;</li>
                                <li>1369 rivi&#xE4; JavaScripti&#xE4;</li>
                                <li>1176 rivi&#xE4; HTML:&#xE4;&#xE4;</li>
                                <li>Yhteens&#xE4; 6696 rivi&#xE4; koodia</li>
                            </ul>
                        </div>
                        <h4>K&#xE4;ytt&#xE4;j&#xE4;t</h4>
                        <div class="taulukko">
                            <ul>
                                <li>~100 rekister&#xF6;itynytt&#xE4; k&#xE4;ytt&#xE4;j&#xE4;&#xE4;</li>
                                <li>~300 istuntoa</li>
                                <li>3 ilmoitettua kyyti&#xE4;</li>
                            </ul>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </section>
    <!--PORTFOLIO CONTENT -->
    <!--FRONTEND-->
    <section id="main" class="wrapper">
        <div class="inner">
            <div class="content" id="angular">
                <h3>Esisanat</h3>
                <blockquote>T&#xE4;m&#xE4; on toinen web applikaatio jonka parissa ty&#xF6;skennellyt.</blockquote>
                <blockquote>Projektissa oli tarkoituksena luoda palvelu, jossa k&#xE4;ytt&#xE4;j&#xE4;t voivat luoda ja j&#xE4;rjestell&#xE4; itselleen kimppakyytej&#xE4;. Palvelua voidaan k&#xE4;ytt&#xE4;&#xE4; sek&#xE4; www-selaimen ett&#xE4; mobiilisovelluksen kautta. Tarkoituksena oli, ett&#xE4; sovelluksen k&#xE4;ytt&#xF6; olisi mahdollisimman helppoa.</blockquote>
                <p>OOlin projektissa k&#xE4;yt&#xE4;nn&#xF6;ss&#xE4; joka paikan h&#xF6;yl&#xE4;. Projektin alussa py&#xF6;rittelin meille ER-mallin, transformoin sen ja tein siit&#xE4; SQL skriptin. Suuri osa isoista p&#xE4;&#xE4;t&#xF6;ksist&#xE4;, kuten teknologiat, lopullinen tietokantamalli ja arkkitehtuuri kuitenkin soviteltiin yhdess&#xE4; tiimikaverini Mika Tonterin kanssa. Alkuun p&#xE4;&#xE4;semisen j&#xE4;lkeen tein kuitenkin jonkin verran enemm&#xE4;n frontendi&#xE4;. Tein esimerkiksi profiilisivun, authdialogin, ja todenn&#xE4;k&#xF6;isesti kaikki applikaatiosta l&#xF6;ytyv&#xE4;t lomakkeet ainakin kahteen kertaan (kyydin luominen, kirjautuminen, rekister&#xF6;ityminen, puhelinnumeron vaihto). T&#xE4;m&#xE4;n lis&#xE4;ksi kuvasin, ohjasin ja k&#xE4;sikirjoitin projektin aikana my&#xF6;s 
                    <a target="_blank" href="https://www.youtube.com/watch?v=PFZiXJvzUyE">mainosvideon</a> jonka ensi-ilta oli 28.3.2018. Backendiin tein k&#xE4;yt&#xE4;nn&#xF6;ss&#xE4; aivan normaaleita CRUD reittej&#xE4;, mutta mukaan mahtui my&#xF6;s muutama haastavampi ongelma, joista yhden ratkaisu on tulossa vastaan alhaalla.
                </p>
                <p>
                        Osaamisen todistamiseksi n&#xE4;yt&#xE4;n t&#xE4;ss&#xE4; p&#xE4;&#xE4;osin arvostelun toteutusta. Se on hyv&#xE4; esimerkki, koska se on 99% implementoimani ja se ominaisuus koskettaa st&#xE4;kin jokaista kohtaa. Lis&#xE4;ksi kerron hieman my&#xF6;s siit&#xE4;, kuinka applikaatio on konfiguroitu produktioon.
                </p>
                <section>
                    <h3>Yleiskatsaus arvosteluun</h3>
                        <!--life of a ridecreate data-->
                        <div class="btn-holder">
                            <button class="btn-left button" onclick="plusDivs(-1)">&#x276E;</button>
                            <div class="nmb-holder">
                                <div class="slideshow_picture_numbers">
                                    <span class="active_slideshow_picture_number">1</span>
                                    <span class="passive_slideshow_picture_number">2</span>
                                    <span class="passive_slideshow_picture_number">3</span>
                                    <span class="passive_slideshow_picture_number">4</span>
                                </div>
                                <div class="slideshow_picture_numbers">                                        
                                    <span class="passive_slideshow_picture_number">1</span>
                                    <span class="active_slideshow_picture_number">2</span>
                                    <span class="passive_slideshow_picture_number">3</span>
                                    <span class="passive_slideshow_picture_number">4</span>
                                </div>
                                <div class="slideshow_picture_numbers">
                                    <span class="passive_slideshow_picture_number">1</span>
                                    <span class="passive_slideshow_picture_number">2</span>
                                    <span class="active_slideshow_picture_number">3</span>
                                    <span class="passive_slideshow_picture_number">4</span>
                                </div>
                                <div class="slideshow_picture_numbers">
                                    <span class="passive_slideshow_picture_number">1</span>                                        
                                    <span class="passive_slideshow_picture_number">2</span>
                                    <span class="passive_slideshow_picture_number">3</span>
                                    <span class="active_slideshow_picture_number">4</span>
                                </div>
                            </div>
                            <button class="btn-right button" onclick="plusDivs(+1)">&#x276F;</button>
                        </div>
                        <div class="slideshow_pictures image fit">
                             <figcaption>1. K&#xE4;ytt&#xE4;j&#xE4;&#xE4; ei ole viel&#xE4; arvosteltu (ja k&#xE4;ytt&#xE4;j&#xE4; ei voi arvostella t&#xE4;t&#xE4; k&#xE4;ytt&#xE4;j&#xE4;&#xE4;)</figcaption>
                            <img src="images/kyytiin/life_of_data/not_reviewed.webp" alt="Kyyti.in websovelluksen kyytisivu">
                        </div>
                        <div class="slideshow_pictures image fit">
                            <figcaption>2. K&#xE4;ytt&#xE4;j&#xE4; voi arvostella toisen</figcaption>
                            <img src="images/kyytiin/life_of_data/can_review.webp" alt="Kyyti.in websovelluksen kyytisivu">
                        </div>
                        <div class="slideshow_pictures image fit">
                            <figcaption>3. Arvosteluprosessi on k&#xE4;ynniss&#xE4;</figcaption>
                            <img src="images/kyytiin/life_of_data/reviewing.webp" alt="Kyyti.in websovelluksen kyytisivu">
                        </div>
                        <div class="slideshow_pictures image fit">
                            <figcaption>4. K&#xE4;ytt&#xE4;j&#xE4; on arvosteltu, ja arvio haetaan tietokannasta</figcaption>
                            <img src="images/kyytiin/life_of_data/reviewed.webp" alt="Kyyti.in websovelluksen kyytisivu">
                        </div>
                        
                        <!--life of a ridecreate data
                        <span class="image fit">
                            <img src="images/kyytiin/frontpage.webp" alt="Kyyti.in websovelluksen kyytisivu" />
                        </span>-->
                <h3>Kuinka arvosteluoikeus jaetaan?</h3>
                <div class="btn-holder">
                    <button class="btn-left button" onclick="plusDivs2(-1)">&#x276E;</button>
                        <div class="nmb-holder">
                            <div class="code_picture_numbers">
                                <span class="active_slideshow_picture_number">1</span>
                                <span class="passive_slideshow_picture_number">2</span>
                                <span class="passive_slideshow_picture_number">3</span>
                            </div>
                            <div class="code_picture_numbers">                                        
                                <span class="passive_slideshow_picture_number">1</span>
                                <span class="active_slideshow_picture_number">2</span>
                                <span class="passive_slideshow_picture_number">3</span>
                            </div>
                            <div class="code_picture_numbers">
                                <span class="passive_slideshow_picture_number">1</span>
                                <span class="passive_slideshow_picture_number">2</span>
                                <span class="active_slideshow_picture_number">3</span>
                            </div>
                        </div>
                    <button class="btn-right button" onclick="plusDivs2(+1)">&#x276F;</button>
                </div>
                <div class="slideshow_code">
                        <figcaption>Mit&#xE4;: Kutsutaan allowReview funktiota joka kutsuu review service&#xE4;</figcaption>
                        <figcaption>Tiedosto: userdetails.component.ts</figcaption>
                        <figcaption>Paikka: frontend</figcaption>    
                          <pre>                            <code class="language-javascript">
<!--JS 1. -->
ngOnInit() {
    this.canReview = false;
    this.customer_id = this.route.snapshot.paramMap.get(&apos;customer_id&apos;);
    this.allowReview();
    this.createForm();
}
                                
allowReview() {
    this.reviewService.allowReview(this.customer_id, this.localAuthService.decodeToken())
      .then(response =&gt; this.canReview = true)
      .catch((err) =&gt; {
        console.error(&apos;allowReview ep&#xE4;onnistui: &apos; + err.message)
      });
}
<!--JS-->
                        </code>
                    </pre>
                </div>
                <div class="slideshow_code">
                        <figcaption>Mit&#xE4;: allowReview omassa elementiss&#xE4;&#xE4;n</figcaption>
                        <figcaption>Tiedosto: review.service.ts</figcaption>
                        <figcaption>Paikka: frontend</figcaption>    
                    <pre>                        <code class="language-javascript">
<!--JS 1. -->
allowReview(user, user2) {
    let response = new Promise((resolve, reject) =&gt; {
      this.http.get(`${environment.apiUrl}/review/canReview/${user}/${user2}`)
        .toPromise()
        .then(
          data =&gt; {
            resolve(data);
          },
          err =&gt; {
            reject(err);
          })
    })
    return response;
}
<!--JS-->
                        </code>
                    </pre>
                </div>
                <div class="slideshow_code">
                    <figcaption>Mit&#xE4;: Pitk&#xE4; ja ei niin elegantti funktio siit&#xE4;, miten arvosteluoikeus jaetaan</figcaption>
                    <figcaption>Tiedosto: reviewcontroller.js</figcaption>
                    <figcaption>Paikka: backend</figcaption>    
                <pre>                        <code class="language-javascript">
    <!--JS 1. -->
/*
T&#xE4;m&#xE4; funktio palauttaa joko 403 tai 200. Jos 200 k&#xE4;ytt&#xE4;j&#xE4; voi arvostella
Tarkoituksena on p&#xE4;&#xE4;tell&#xE4; voiko kyytil&#xE4;inen tai kyydin luoja arvostella toinen toistaan
Ensimm&#xE4;isess&#xE4; queryss&#xE4; etsit&#xE4;&#xE4;n parametrein&#xE4; tulleiden k&#xE4;ytt&#xE4;j&#xE4; ideiden&#xE4; perusteella
Onko arvoilla yhteys tietokannassa CustomersRides_ride taulun kautta
Toisessa queryss&#xE4; tarkastellaan toisinp&#xE4;in 
TODO: Refaktoroi k&#xE4;ytt&#xE4;m&#xE4;&#xE4;n yht&#xE4; query&#xE4;
*/
exports.canReview = (req, res, next) =&gt; {
    //Jos palauttaa arvoja, kyydin luoja voi arvostella kyytil&#xE4;isi&#xE4;
    Review.sequelize.query(&apos;
    SELECT r.ride_id, r.customer_id AS creator_customer_id, CRr.customer_id AS joiner_customer_id 
    FROM Rides r INNER JOIN CustomersRides_ride CRr ON r.ride_id = CRr.ride_id 
    WHERE r.customer_id = :creator_customer_id AND CRr.customer_id = :joiner_customer_id&apos;,
		{
            replacements: 
            { 
                creator_customer_id: req.params.creator_customer_id, 
                joiner_customer_id: req.params.joiner_customer_id 
            },
			type: Review.sequelize.QueryTypes.SELECT
		})
		.then(data =&gt; {
			//Jos edellinen query ei palauttanut mit&#xE4;&#xE4;n, menn&#xE4;&#xE4;n seuraavaan ja etsit&#xE4;&#xE4; sielt&#xE4;
			if (data.length === 0) {
				//Jos query palauttaa arvoja, kyytil&#xE4;inen voi arvostella luojaa
                Review.sequelize.query(&apos;
                SELECT CRr.ride_id, CRr.customer_id AS joiner_customer_id, r.customer_id AS creator_customer_id 
                FROM CustomersRides_ride CRr INNER JOIN Rides r on CRr.ride_id = r.ride_id 
                WHERE r.customer_id = :creator_customer_id AND CRr.customer_id = :joiner_customer_id&apos;,
					{
                        replacements: 
                        {   //ID:t ovat v&#xE4;&#xE4;rinp&#xE4;in t&#xE4;ysin h&#xE4;m&#xE4;r&#xE4;st&#xE4; syyst&#xE4;
                            //Toimii n&#xE4;inp&#xE4;in ja testattu ulostulevan datan olevan oikeaa
                            //kaikissa skenaaroissa
                            creator_customer_id: req.params.joiner_customer_id, 
                            joiner_customer_id: req.params.creator_customer_id
                        },
                        type: Review.sequelize.QueryTypes.SELECT
                    })
                    .then(data2 =&gt; {
                        if (data2.length === 0) {
                            res.status(403).json({
                                message: &apos;You are not able to review&apos;
                            })
                        } else {
                            res.status(200).json({
                                message: &apos;Proceed&apos;
                            });
                        }
                    })
                    .catch(err =&gt; console.log(err));
            } else {
                res.status(200).json({
                    message: &apos;Proceed&apos;
                });
            }
        })
        .catch(err =&gt; console.log(err))
};
        <!--JS-->
                        </code>
                    </pre>
                </div>
    
            <!--Create review-->
            <div class>
                <h3>Arvostelun luominen</h3>
                <div class="btn-holder">
                    <button class="btn-left button" onclick="plusDivs4(-1)">&#x276E;</button>
                        <div class="nmb-holder">
                            <div class="createReview_picture_numbers">
                                <span class="active_slideshow_picture_number">1</span>
                                <span class="passive_slideshow_picture_number">2</span>
                                <span class="passive_slideshow_picture_number">3</span>
                                <span class="passive_slideshow_picture_number">4</span>

                            </div>
                            <div class="createReview_picture_numbers">                                        
                                <span class="passive_slideshow_picture_number">1</span>
                                <span class="active_slideshow_picture_number">2</span>
                                <span class="passive_slideshow_picture_number">3</span>
                                <span class="passive_slideshow_picture_number">4</span>
                            </div>
                            <div class="createReview_picture_numbers">
                                <span class="passive_slideshow_picture_number">1</span>
                                <span class="passive_slideshow_picture_number">2</span>
                                <span class="active_slideshow_picture_number">3</span>
                                <span class="passive_slideshow_picture_number">4</span>

                            </div>
                            <div class="createReview_picture_numbers">
                                <span class="passive_slideshow_picture_number">1</span>
                                <span class="passive_slideshow_picture_number">2</span>
                                <span class="passive_slideshow_picture_number">3</span>
                                <span class="active_slideshow_picture_number">4</span>
                            </div>
                        </div>
                    <button class="btn-right button" onclick="plusDivs4(+1)">&#x276F;</button>
                </div>
                <div class="slideshow_createReview">
                        <figcaption>Mit&#xE4;: Arvostelulomakkeen template</figcaption>
                        <figcaption>Tiedosto: userdetails.component.html</figcaption>
                        <figcaption>Paikka: frontend</figcaption>    
                    <pre>                        <code class="language-html">
                            <xmp>
<mat-card *ngIf="canReview">
    <mat-card-title>Arvioi käyttäjä:</mat-card-title>
    <form [formGroup]="reviewForm" (ngSubmit)="sendReview(reviewForm.value)">
        <div class="stars">
            <star-rating-comp 
            fxLayoutAlign="start center" 
            [hoverEnabled]="true" 
            [speed]="'immediately'" 
            [size]="'large'" 
            [starType]="'svg'"
            formControlName="stars"></star-rating-comp>
        </div>
        <mat-form-field>
            <input matInput #review_text id="review_text" name="review_text" formControlName="review_text" placeholder="Lisätiedot">
            <mat-hint>{{review_text.value.length}} / 512</mat-hint>
        </mat-form-field>
        <div>
            <button [disabled]="reviewForm.invalid" mat-raised-button color="primary" (click)="refresh()">Anna arvio!</button>
        </div>
    </form>
</mat-card>                                    
                            </xmp>
                        </code>
                    </pre>
                </div>
                <div class="slideshow_createReview">
                    <figcaption>Mit&#xE4;: Skriptit arvostelun luomista varten</figcaption>
                    <figcaption>Tiedosto: userdetails.component.ts</figcaption>
                    <figcaption>Paikka: frontend</figcaption>    
                    <pre>                        <code class="language-javascript">
                            <xmp>
createForm() {
    this.reviewForm = this.fb.group({
      stars: ['', Validators.compose([Validators.required, Validators.min(1), Validators.max(5)])],
      review_text: ['', Validators.maxLength(512)],
      customer_id: [this.customer_id],
    });
}
                                    
let reviewForm = 
{
    'stars': 4,
    'review_text': 'Minun mielestäni hyvä kyyti',
    'customer_id': 'UUIDV4',
}

sendReview(reviewForm) {
    this.reviewService.sendReview(reviewForm)
      .then(response => console.log('ok'))
      .catch((err) => {
        this.errorUiService.popErrorDialog(err);
        console.error('sendReview epäonnistui: ' + err.message)
      });
}
                            </xmp>
                        </code>
                    </pre>
                </div>
                <div class="slideshow_createReview">
                    <figcaption>Mit&#xE4;: Skriptit arvostelun luomista varten</figcaption>
                    <figcaption>Tiedosto: review.service.ts</figcaption>    
                    <figcaption>Paikka: frontend</figcaption>    
                    <pre>                        <code class="language-javascript">
                            <xmp>
sendReview(reviewForm) {
  let response = new Promise((resolve, reject) => {
    this.http.post(`${environment.apiUrl}/review/${reviewForm.customer_id}`, reviewForm)
      .toPromise()
      .then(
        data => {
          resolve(data);
        },
        err => {
          reject(err);
        })
  })
  return response;
}
                            </xmp>
                        </code>
                    </pre>
                </div>
                <div class="slideshow_createReview">
                    <figcaption>Mit&#xE4;: Skriptit arvostelun luomista varten</figcaption>
                    <figcaption>Tiedosto: reviewcontroller.js</figcaption>  
                    <figcaption>Paikka: backend</figcaption>    
                    <pre>                        <code class="language-javascript">
                            <xmp>
exports.createReview = (req, res, next) => {
    const data = {
        stars: req.body.stars,
        review_text: req.body.review_text,
        customer_id: req.body.customer_id,
    };
    Review.create(data)
        .then((ride) => {
            res.status(200).json({
                message: 'Review created',
                data: data
            });
        })
        .catch((err) => {
            console.log(err)
        })
};
                            </xmp>
                        </code>
                    </pre>
                </div>    
            </div>
                    <h3>Arvostelun tietokantarakenne</h3>
                    <div class="btn-holder">
                            <button class="btn-left button" onclick="plusDivs3(-1)">&#x276E;</button>
                            <div class="nmb-holder">
                                <div class="sql_picture_numbers">
                                    <span class="active_slideshow_picture_number">1</span>
                                    <span class="passive_slideshow_picture_number">2</span>
                                </div>
                                <div class="sql_picture_numbers" style="display:none;">                                        
                                    <span class="passive_slideshow_picture_number">1</span>
                                    <span class="active_slideshow_picture_number">2</span>
                                </div>
                            </div>
                            <button class="btn-right button" onclick="plusDivs3(+1)">&#x276F;</button>
                        </div>
                <div class="slideshow_sql">
                    <figcaption>Mit&#xE4;: Koko SQL skripti</figcaption>
                    <pre>                        <code class="language-sql">
                            <!--tähän-->
CREATE DATABASE IF NOT EXISTS kyyti;
USE kyyti;

DROP TABLE IF EXISTS CustomersRides_ride;
DROP TABLE IF EXISTS CustomersCars;
DROP TABLE IF EXISTS Cars;
DROP TABLE IF EXISTS Reviews;
DROP TABLE IF EXISTS Notifications;
DROP TABLE IF EXISTS Requests;
DROP TABLE IF EXISTS Rides;
DROP TABLE IF EXISTS Customers;


CREATE TABLE IF NOT EXISTS Customers (
);

CREATE TABLE IF NOT EXISTS Rides (
);

CREATE TABLE IF NOT EXISTS Requests (
);

CREATE TABLE IF NOT EXISTS Notifications (
);

CREATE TABLE IF NOT EXISTS Reviews (
  review_id VARCHAR(100) NOT NULL PRIMARY KEY, 
  customer_id VARCHAR(100) NOT NULL,
  stars TINYINT NOT NULL,
  review_text VARCHAR(600),
  review_created DATETIME default CURRENT_TIMESTAMP,
  FOREIGN KEY(customer_id) REFERENCES Customers(customer_id)
    ON UPDATE RESTRICT ON DELETE RESTRICT
);

CREATE TABLE IF NOT EXISTS Cars ( 
);

CREATE TABLE IF NOT EXISTS CustomersCars (
);

CREATE TABLE IF NOT EXISTS CustomersRides_ride (
);

                    </code>
                </pre> 
            </div>
            <div class="slideshow_sql">
                    <figcaption>Mit&#xE4;: Review taulun Sequelize model</figcaption>
                    <figcaption>Tiedosto: review.js</figcaption>
                    <figcaption>Paikka: backend</figcaption>    

                    <pre>    <code class="language-javascript">
const db = require(&apos;./index&apos;);

module.exports = (sequelize, DataTypes) =&gt; {
    let Review = sequelize.define(&apos;Review&apos;, {
        review_id: {
            type: DataTypes.UUID,
            defaultValue: DataTypes.UUIDV4,
            allowNull: false,
            primaryKey: true
        },
        customer_id: {
            type: DataTypes.UUID,
            defaultValue: DataTypes.UUIDV4,
            allowNull: false,
            foreignKey: true
        },
        stars: {
            type: DataTypes.TINYINT
        },
        review_text: {
            type: DataTypes.STRING
        },
        review_created: {
            type: DataTypes.DATE,
            defaultValue: DataTypes.NOW,
        },
    },
        {
            timestamps: false,
            tableName: &apos;Reviews&apos;,
            freezeTableName: true,
        });

    return Review;
};
                            </code>
                        </pre>
                    </div>
            </section></div>
        </div></section>
                <!--BACKEND-->
        <section id="main" class="wrapper">
            <div class="inner">
                <div class="content" id="nodejs">
                    <h3>Muut n&#xE4;ytett&#xE4;v&#xE4;t artefaktit</h3>
                    <div>
                    <h4>getUserMadeRides</h4>
                    <p>Minulle suotiin armollisesti taski, jossa pyydettiin hakemaan k&#xE4;ytt&#xE4;j&#xE4;lle h&#xE4;nen kyytisivulleen kyytiin liittyneet k&#xE4;ytt&#xE4;j&#xE4;t. Kyseinen funktio tekee ensin kyselyn jossa etsit&#xE4;&#xE4;n tietyn k&#xE4;ytt&#xE4;j&#xE4;n tiettyyn kyytiin liittyv&#xE4;t muut k&#xE4;ytt&#xE4;j&#xE4;t. T&#xE4;m&#xE4;n j&#xE4;lkeen haetaan itse kyyti taulun tiedot (n&#xE4;m&#xE4; halutaan palauttaa aina). Jos aikaisemmassa kyselyss&#xE4; k&#xE4;ytt&#xE4;ji&#xE4; l&#xF6;ytyi, haetaan t&#xE4;m&#xE4;n j&#xE4;lkeen heid&#xE4;n tietonsa. 
                        <br>
                        Sequelize palauttaa datan JSONina, mutta haluaa vastaanottaa parametrit operaatioihin taulukoina, joten py&#xF6;r&#xE4;ytin for loopin, joka ty&#xF6;nt&#xE4;&#xE4;
                        JSON-taulukon tiedot taulukkoon jolla varsinainen haku sitten suoritetaan. Hakuun k&#xE4;ytet&#xE4;&#xE4;n Sequelizen &apos;in&apos; operaattoria jonka 
                        toimintaperiaate vastaa SQL:n IN operaattoria. 
                    </p>
                    <figcaption>Mit&#xE4;: Funktio jolla haetaan k&#xE4;ytt&#xE4;j&#xE4;n tekem&#xE4; kyyti, ja sille liittyneet k&#xE4;ytt&#xE4;j&#xE4;t (jos niit&#xE4; on)</figcaption>
                    <figcaption>Tiedosto: ridecontroller.js</figcaption>  
                    <figcaption>Paikka: backend</figcaption>    
                        <pre>                            <code class="language-javascript">
exports.getUserMadeRides = (req, res, next) =&gt; {
  //etsit&#xE4;&#xE4;n Rides taulusta ridejoinereita, innerjoinin avulla. 
  Ride.sequelize.query(
  SELECT CRr.customer_id AS joiner_id FROM Rides r 
  INNER JOIN CustomersRides_ride CRr on r.ride_id = CRr.ride_id 
  WHERE r.ride_id = :ride_id AND r.customer_id = :customer_id;,
    {
      replacements: { ride_id: req.params.ride_id, customer_id: req.params.customer_id },
      type: Ride.sequelize.QueryTypes.SELECT
    })
    .then(riders =&gt; {
      Ride.find({
        where: { ride_id: req.params.ride_id }
      })
        //haetaan k&#xE4;ytt&#xE4;j&#xE4;t
        .then(ride =&gt; {
          //Ty&#xF6;nnet&#xE4;&#xE4;n ridersit json taulukosta #oikeaan taulukkoon
          //Sequelize haluaa taulukoita [Op.in] operaatioon 
          var i;
          var joiners = [];
          for (i = 0; i &lt; riders.length; i++) {
            joiners.push(riders[i].joiner_id);
          }
          //Jos taulukko j&#xE4;i tyhj&#xE4;ksi (eli kyytil&#xE4;isi&#xE4; ei ollut), l&#xE4;hetet&#xE4;&#xE4;n pelk&#xE4;n kyydin tiedot
          if (joiners.length &gt; 0) {
            User.findAll({
              attributes: [&apos;firstName&apos;, &apos;lastName&apos;, &apos;email&apos;, &apos;phoneNumber&apos;, &apos;customer_id&apos;],
              where: {
                Customer_id: {
                  [Op.in]: [joiners]
                }
              }
            })
              .then(joiners =&gt; {
                res.status(200).json({
                  message: &apos;Ride and joiners found&apos;,
                  ride: ride,
                  joiners: joiners
                })
              })
          } else {
            res.status(200).json({
              message: &apos;Ride found&apos;,
              ride: ride
            })
          }
        })
    })
    .catch((err) =&gt; console.log(&apos;getUserJoinedRides failed: &apos; + err.message));
};
                             </code>
                         </pre>
                     </div>
                     <div>
                        <h4>Web App Manifest</h4>
                        <p>Koska Kyyti.in on moderni progressiivinen web applikaatio, meid&#xE4;n piti tehd&#xE4; web manifest tiedosto. Sit&#xE4; k&#xE4;ytet&#xE4;&#xE4;n web applikaatioiden
                            asentamiseen laitteeseen. Oli se sitten tietokone tai &#xE4;lypuhelin. T&#xE4;llaisen web manifestin avulla Google Chromea k&#xE4;ytt&#xE4;v&#xE4;lt&#xE4; 
                            k&#xE4;vij&#xE4;lt&#xE4; kysyt&#xE4;&#xE4;n suoraan haluaako h&#xE4;n asentaa applikaation puhelimeensa. Koska meill&#xE4; on rekister&#xF6;ity service worker, asentuu 
                            web applikaatiomme &quot;natiivisti&quot; Android puhelimille. Applikaatio n&#xE4;kyy sovellukset listauksessa ja toimii kuten natiivi applikaatio toimisi. 
                        </p>
                        <figcaption>Mit&#xE4;: Webmanifest tiedosto jota k&#xE4;ytet&#xE4;&#xE4;n web applikaatioiden asentamiseen k&#xE4;ytt&#xE4;j&#xE4;n laitteeseen</figcaption>
                        <figcaption>Tiedosto: manifest.webmanifest</figcaption>  
                        <figcaption>Paikka: frontend</figcaption>    
                            <pre>                                <code class="language-json">
{
    &quot;short_name&quot;: &quot;Kyyti.in&quot;,
    &quot;name&quot;: &quot;Kyyti.in&quot;,
    &quot;description&quot;: &quot;Uuden ajan kimppakyytipalvelu&quot;,
    &quot;background_color&quot;: &quot;#fff&quot;,
    &quot;theme_color&quot;: &quot;#689F38&quot;,
    &quot;icons&quot;: [
        {
            &quot;src&quot;: &quot;favicon.ico&quot;,
            &quot;sizes&quot;: &quot;32x32&quot;,
            &quot;type&quot;: &quot;image/png&quot;
        },
        {
            &quot;src&quot;: &quot;/assets/images/android-chrome-192x192.png&quot;,
            &quot;sizes&quot;: &quot;192x192&quot;,
            &quot;type&quot;: &quot;image/png&quot;
        },
        {
            &quot;src&quot;: &quot;/assets/images/kyytiin-512.webp&quot;,
            &quot;sizes&quot;: &quot;512x512&quot;,
            &quot;type&quot;: &quot;image/png&quot;
        }
    ],
    &quot;start_url&quot;: &quot;/index.html&quot;,
    &quot;display&quot;: &quot;standalone&quot;,
    &quot;orientation&quot;: &quot;portrait&quot;
}                               </code>
                            </pre>
                        </div>
                        <div>
                            <h4>Konfiguraatio produktioon</h4>
                            <h5>1. Angular</h5>
                            <p>K&#xE4;yt&#xE4;mme perinteiseen tyyliin ymp&#xE4;rist&#xF6;muuttujia build prosessia ja produktioon ty&#xF6;nt&#xE4;misen helpottamiseksi. 
                                Tapa jolla n&#xE4;it&#xE4; k&#xE4;yt&#xE4;mme, on melko yksiselitteinen. Ensimm&#xE4;isess&#xE4; upotteessa olevaa scripti&#xE4; kutsutaan komentorivilt&#xE4;, 
                                jolloin ty&#xF6;kalu valitsee muuttujiksi produktio versiot. </p>
                            <p>
                            </p><h5>2. .env</h5>
                                .env tiedostoa k&#xE4;ytett&#xE4;ess&#xE4; asetetaan jokaiselle ymp&#xE4;rist&#xF6;lle henkil&#xF6;kohtainen .env tiedosto kansiorakenteen juureen. 
                                Esimerkiss&#xE4; on lokaalin kehitysymp&#xE4;rist&#xF6;n .env tiedosto.
                            <p></p>
                            <div class="btn-holder">
                                <button class="btn-left button" onclick="plusDivs5(-1)">&#x276E;</button>
                                <div class="nmb-holder">
                                    <div class="produktio_picture_numbers">
                                        <span class="active_slideshow_picture_number">1</span>
                                        <span class="passive_slideshow_picture_number">2</span>
                                    </div>
                                    <div class="produktio_picture_numbers" style="display:none;">  
                                        <span class="passive_slideshow_picture_number">1</span>
                                        <span class="active_slideshow_picture_number">2</span>
                                    </div>
                                </div>
                                <button class="btn-right button" onclick="plusDivs5(+1)">&#x276F;</button>
                            </div>        
                            <div class="slideshow_produktio">
                                    <figcaption>Mit&#xE4;: Angularin build prosessin k&#xE4;ytt&#xE4;m&#xE4;t muuttujat</figcaption>
                                    <figcaption>Tiedosto: package.sjon, environment.ts ja environment.prod.ts</figcaption>  
                                    <figcaption>Paikka: frontend (buildatessa)</figcaption>                
                                <pre>                                    <code class="language-json">
&quot;scripts&quot;: { &quot;build&quot;: &quot;ng build --prod -aot --env=prod&quot; }
                                    </code>
                                    <code class="language-javascript">
export const environment = {
    production: false,
    apiUrl: &apos;http://localhost:3000/api&apos;,
    serverUrl: &apos;http://localhost:3000&apos;
};

export const environment = {
    production: true,
    apiUrl: &apos;https://app.kyyti.in/api&apos;,
    serverUrl: &apos;https://app.kyyti.in&apos;
};
                                    </code>
                                </pre>
                            </div>
                            <div class="slideshow_produktio" style="display:none;">
                                <figcaption>Mit&#xE4;: .env muuttuja, jota k&#xE4;ytet&#xE4;&#xE4;n konfiguroimiseen tiettyyn ymp&#xE4;rist&#xF6;&#xF6;n</figcaption>
                                <figcaption>Tiedosto: .env ja config.js</figcaption>  
                                <figcaption>Paikka: backend (tietokantakonffit)</figcaption>                
                                <pre>                                    <code class="language-ini">
DB_USER=root
DB_PASSWORD=Kyyti.in.DB
DB_DATABASE=kyyti
DB_HOST=localhost
DB_DIALECT=mysql
PORT=3000
JWT_SECRET=secret
MAILER_USER=kyytiinapp.noreply@gmail.com
MAILER_PASSWORD=password
MAILER_SERVICE_PROVIDER=Gmail
                                    </code>
                                    <code class="language-javascript">

module.exports = {
    development: {
      username: process.env.DB_USER,
      password: process.env.DB_PASSWORD,
      database: process.env.DB_DATABASE,
      host: process.env.DB_HOST,
      dialect: &quot;mysql&quot;
}
                                    </code>
                                </pre>
                            </div>
                        </div>
                        <div>
                            <h4>Angular service worker</h4>
                            <p>Angularin mukana on tullut sen oma service worker versiosta 5.0.0 asti. Sen k&#xE4;ytt&#xF6;&#xF6;n ottoon
                                riitt&#xE4;&#xE4; &quot;ngsw-config.json&quot; tiedoston luominen ja konfiguroiminen. Konfiguraatio on muuten hyvin simppeli 
                                ja valmiilta pohjalta rakennettu, mutta olemme lis&#xE4;nneet sinne joka hakee FontAwesomen fontit sek&#xE4; noutaa assettimme
                                heti sivustolle saavuttaessa. T&#xE4;m&#xE4; kuluttaa v&#xE4;h&#xE4;n dataa koska assettimme ovat pieni&#xE4;, suurena hy&#xF6;tyn&#xE4; on applikaation
                                sulava k&#xE4;ytt&#xF6; heti ensilatauksesta asti. <br>
                                Toisena isona asiana on k&#xE4;ytt&#xE4;j&#xE4;profiilin profiilikuvan lataus. Ne ladataan tarvittaessa ja s&#xE4;il&#xF6;t&#xE4;&#xE4;n cacheen kunnes tiedostoon
                                tapahtuu muutoksia. Tiedostoja ei laiskan latauksen takia p&#xE4;ivitet&#xE4; esimerkiksi hitaan internetin takia. 
                              </p>
                            <figcaption>Mit&#xE4;: Angularin service workerin konfiguraatiotiedosto</figcaption>
                            <figcaption>Tiedosto: ngsw-config.json</figcaption>  
                            <figcaption>Paikka: frontend</figcaption>                
                            <pre>                                <code class="language-json">
{
    &quot;index&quot;: &quot;/index.html&quot;,
    &quot;assetGroups&quot;: [
        {
            &quot;name&quot;: &quot;Kyyti.in&quot;,
            &quot;installMode&quot;: &quot;prefetch&quot;,
            &quot;resources&quot;: {
                &quot;files&quot;: [
                    &quot;/favicon.ico&quot;,
                    &quot;/index.html&quot;
                ],
                &quot;versionedFiles&quot;: [
                    &quot;/*.bundle.css&quot;,
                    &quot;/*.bundle.js&quot;,
                    &quot;/*.chunk.js&quot;
                ],
                &quot;urls&quot;: [
                    &quot;https://use.fontawesome.com/releases/v5.0.8/css/all.css&quot;
                ]
            }
        },
        {
            &quot;name&quot;: &quot;assets&quot;,
            &quot;installMode&quot;: &quot;prefetch&quot;,
            &quot;updateMode&quot;: &quot;prefetch&quot;,
            &quot;resources&quot;: {
                &quot;files&quot;: [
                    &quot;/assets/**&quot;
                ]
            }
        },
        {
            &quot;name&quot;: &quot;public images&quot;,
            &quot;installMode&quot;: &quot;lazy&quot;,
            &quot;updateMode&quot;: &quot;lazy&quot;,
            &quot;resources&quot;: {
                &quot;files&quot;: [
                    &quot;/public/images/**&quot;
                ]
            }
        }
    ]
}
                                </code>
                            </pre>
                        </div>
                    </div>
            </div>
        </section>
            
        <section id="main" class="wrapper">
            <div class="inner">
                <div class="content" id="reflektointi">
                    <h3>Reflektointi</h3>
                    <p>Selailin redditist&#xE4; /r/learnprogramming subredditti&#xE4;, ja t&#xF6;rm&#xE4;sin seuraavanlaiseen m&#xE4;&#xE4;ritelm&#xE4;&#xE4;n ohjelmointiosaamisen tasoista</p>
                    <ul>
                        <li>1. Osaa tehd&#xE4; tutoriaalien perusteella</li>
                        <li>2. Osaa kirjoittaa koodia tutoriaalien perusteella ja turvautuu l&#xE4;hes kaikessa Googleen</li>
                        <li>3. Osaa kirjoittaa jotain itse, ja joissain turvautuu tutoriaaleihein sek&#xE4; dokumentaatioon ja Googleen</li>
                        <li>4. Osaa kirjoittaa itse ja turvautuu dokumentaatioon ja Googleen</li>
                        <li>5. Kirjoittaa tutoriaalit</li>
                    </ul>
                    <p>En tied&#xE4; onko listaus kuinka tarkka tai hyv&#xE4;, mutta mielest&#xE4;ni se kuulostaa j&#xE4;rkev&#xE4;&#xE4;nk&#xE4;yv&#xE4;lt&#xE4;. Verratessa itse&#xE4;ni tuohon listaukseen,
                         kokisin joissain asioissa olevani tasolla 2, ja joissain asioissa tasolla 3 ja 4. Ennen t&#xE4;t&#xE4; projektia olin suurimmassa osassa asioita tasolla 2. 
                    </p>
                    <p>T&#xE4;m&#xE4; usean kuukauden stressaava, jopa v&#xE4;lill&#xE4; crunchiin verrattavissa oleva jakso, opetti
                        paljon tehokkaasta ohjelmoinnista ja kuinka ominaisuudet saadaan nopeasti valmiiksi. Aikataulun ja
                        ty&#xF6;m&#xE4;&#xE4;r&#xE4;n takia teoreettinen osuus j&#xE4;i paljon pienem&#xE4;lle ja tietynlainen syv&#xE4;oppiminen sek&#xE4; sataprosenttinen
                        ymm&#xE4;rrys uusista asioista j&#xE4;i puuttumaan.
                        <br>Kokisin joka tapauksessa t&#xE4;m&#xE4;n projektin j&#xE4;lkeen olevampi paljon valmiimpi ja todella paljon parempi
                        ohjelmoija ja tekniikan tiet&#xE4;j&#xE4; kuin ennen t&#xE4;t&#xE4;.
                    </p>
                </div>
            </div>
        </section>

    <footer id="footer">
    <div class="inner">
        <div class="content">
            <section>
                <h3>/whois Teemu</h3>
                <p>Olen 29-vuotias ikinuori pojankloppi</p>
            </section>
            <section>
                <h4>Teemu sosiaalisessa mediassa</h4>
                <ul class="plain">
                    <li>
                        <a target="_blank" href="https://twitter.com/t_poelkki">
                            <i class="icon fa-twitter">&#xA0;</i>Twitter</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/teemu-p%C3%B6lkki/">
                            <i class="icon fa-linkedin">&#xA0;</i>LinkedIn</a>
                    </li>
                </ul>
            </section>
        </div>
        <div class="copyright">
            &#xA9; Teemu P&#xF6;lkki 2023 - This page was compiled with SSSG - 2020 (c) Teemu Pölkki.

        </div>
    </div>
</footer>

<!-- Scripts -->

<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>
<script src="assets/js/prism.js"></script>
<script src="assets/js/carousel.js"></script>

</body></html>